"use strict";var pe=Object.create;var q=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,xe=Object.prototype.hasOwnProperty;var f=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),De=(e,t)=>{for(var r in t)q(e,r,{get:t[r],enumerable:!0})},z=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of ge(t))!xe.call(e,u)&&u!==r&&q(e,u,{get:()=>t[u],enumerable:!(n=me(t,u))||n.enumerable});return e};var qe=(e,t,r)=>(r=e!=null?pe(ye(e)):{},z(t||!e||!e.__esModule?q(r,"default",{value:e,enumerable:!0}):r,e)),Me=e=>z(q({},"__esModule",{value:!0}),e);var B=f(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.default=Ie;var he=Pe(require("crypto"));function Pe(e){return e&&e.__esModule?e:{default:e}}var h=new Uint8Array(256),M=h.length;function Ie(){return M>h.length-16&&(he.default.randomFillSync(h),M=0),h.slice(M,M+=16)}});var G=f(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.default=void 0;var Oe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;P.default=Oe});var g=f(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.default=void 0;var we=Re(G());function Re(e){return e&&e.__esModule?e:{default:e}}function Ue(e){return typeof e=="string"&&we.default.test(e)}var Se=Ue;I.default=Se});var y=f(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.default=void 0;var Le=Ne(g());function Ne(e){return e&&e.__esModule?e:{default:e}}var i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).substr(1));function Te(e,t=0){let r=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!(0,Le.default)(r))throw TypeError("Stringified UUID is invalid");return r}var Ae=Te;O.default=Ae});var Y=f(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.default=void 0;var Ee=X(B()),ke=X(y());function X(e){return e&&e.__esModule?e:{default:e}}var W,C,H=0,Q=0;function Be(e,t,r){let n=t&&r||0,u=t||new Array(16);e=e||{};let s=e.node||W,d=e.clockseq!==void 0?e.clockseq:C;if(s==null||d==null){let l=e.random||(e.rng||Ee.default)();s==null&&(s=W=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]),d==null&&(d=C=(l[6]<<8|l[7])&16383)}let c=e.msecs!==void 0?e.msecs:Date.now(),a=e.nsecs!==void 0?e.nsecs:Q+1,p=c-H+(a-Q)/1e4;if(p<0&&e.clockseq===void 0&&(d=d+1&16383),(p<0||c>H)&&e.nsecs===void 0&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");H=c,Q=a,C=d,c+=122192928e5;let x=((c&268435455)*1e4+a)%4294967296;u[n++]=x>>>24&255,u[n++]=x>>>16&255,u[n++]=x>>>8&255,u[n++]=x&255;let D=c/4294967296*1e4&268435455;u[n++]=D>>>8&255,u[n++]=D&255,u[n++]=D>>>24&15|16,u[n++]=D>>>16&255,u[n++]=d>>>8|128,u[n++]=d&255;for(let l=0;l<6;++l)u[n+l]=s[l];return t||(0,ke.default)(u)}var Ce=Be;w.default=Ce});var $=f(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.default=void 0;var He=Qe(g());function Qe(e){return e&&e.__esModule?e:{default:e}}function $e(e){if(!(0,He.default)(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var Fe=$e;R.default=Fe});var F=f(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.default=ze;m.URL=m.DNS=void 0;var Je=Z(y()),Ke=Z($());function Z(e){return e&&e.__esModule?e:{default:e}}function Ve(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var b="6ba7b810-9dad-11d1-80b4-00c04fd430c8";m.DNS=b;var j="6ba7b811-9dad-11d1-80b4-00c04fd430c8";m.URL=j;function ze(e,t,r){function n(u,s,d,c){if(typeof u=="string"&&(u=Ve(u)),typeof s=="string"&&(s=(0,Ke.default)(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+u.length);if(a.set(s),a.set(u,s.length),a=r(a),a[6]=a[6]&15|t,a[8]=a[8]&63|128,d){c=c||0;for(let p=0;p<16;++p)d[c+p]=a[p];return d}return(0,Je.default)(a)}try{n.name=e}catch{}return n.DNS=b,n.URL=j,n}});var ee=f(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.default=void 0;var Ge=We(require("crypto"));function We(e){return e&&e.__esModule?e:{default:e}}function Xe(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),Ge.default.createHash("md5").update(e).digest()}var Ye=Xe;U.default=Ye});var re=f(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.default=void 0;var Ze=te(F()),be=te(ee());function te(e){return e&&e.__esModule?e:{default:e}}var je=(0,Ze.default)("v3",48,be.default),et=je;S.default=et});var ue=f(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.default=void 0;var tt=ne(B()),rt=ne(y());function ne(e){return e&&e.__esModule?e:{default:e}}function nt(e,t,r){e=e||{};let n=e.random||(e.rng||tt.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let u=0;u<16;++u)t[r+u]=n[u];return t}return(0,rt.default)(n)}var ut=nt;L.default=ut});var ie=f(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.default=void 0;var it=at(require("crypto"));function at(e){return e&&e.__esModule?e:{default:e}}function ft(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),it.default.createHash("sha1").update(e).digest()}var lt=ft;N.default=lt});var fe=f(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.default=void 0;var dt=ae(F()),st=ae(ie());function ae(e){return e&&e.__esModule?e:{default:e}}var ot=(0,dt.default)("v5",80,st.default),ct=ot;T.default=ct});var le=f(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.default=void 0;var vt="00000000-0000-0000-0000-000000000000";A.default=vt});var de=f(E=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});E.default=void 0;var _t=pt(g());function pt(e){return e&&e.__esModule?e:{default:e}}function mt(e){if(!(0,_t.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var gt=mt;E.default=gt});var se=f(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});Object.defineProperty(o,"v1",{enumerable:!0,get:function(){return yt.default}});Object.defineProperty(o,"v3",{enumerable:!0,get:function(){return xt.default}});Object.defineProperty(o,"v4",{enumerable:!0,get:function(){return Dt.default}});Object.defineProperty(o,"v5",{enumerable:!0,get:function(){return qt.default}});Object.defineProperty(o,"NIL",{enumerable:!0,get:function(){return Mt.default}});Object.defineProperty(o,"version",{enumerable:!0,get:function(){return ht.default}});Object.defineProperty(o,"validate",{enumerable:!0,get:function(){return Pt.default}});Object.defineProperty(o,"stringify",{enumerable:!0,get:function(){return It.default}});Object.defineProperty(o,"parse",{enumerable:!0,get:function(){return Ot.default}});var yt=_(Y()),xt=_(re()),Dt=_(ue()),qt=_(fe()),Mt=_(le()),ht=_(de()),Pt=_(g()),It=_(y()),Ot=_($());function _(e){return e&&e.__esModule?e:{default:e}}});var Lt={};De(Lt,{handleCreateDriversTestData:()=>Ut,handleSampleDriverTippingEvent:()=>St});module.exports=Me(Lt);var _e=require("aws-sdk");var v=qe(se(),1),Wt=v.default.v1,Xt=v.default.v3,J=v.default.v4,Yt=v.default.v5,Zt=v.default.NIL,bt=v.default.version,jt=v.default.validate,er=v.default.stringify,tr=v.default.parse;var oe=require("aws-sdk"),ce=new oe.DynamoDB.DocumentClient,ve="challenge-cloud-native-driver-mgmt-ts",wt=({id:e,firstname:t,lastname:r,driverLicenseId:n})=>({id:e,firstname:t,lastname:r,driverLicenseId:n}),K=async e=>{let{id:t,lastname:r,driverLicenseId:n}=e;return await ce.put({TableName:ve,Item:{id:t,lastname:r,driverLicenseId:n}}).promise(),e};var V=async()=>{let{Items:e}=await ce.scan({TableName:ve}).promise();return e?e.map(t=>wt(t)):[]};var Rt=new _e.SQS,Ut=async()=>{let e=await V();e.length===0?(console.log("creating test data"),await K({id:J(),firstname:"Linda",lastname:"Doe",driverLicenseId:"12345"}),await K({id:J(),firstname:"Dean",lastname:"Driver",driverLicenseId:"9654321"})):console.log(`skipping test data creation ${e.length} drivers exist already`)},St=async()=>{let e=await V(),t=process.env.DRIVER_TIPS_QUEUE_URL;if(e.length>0&&t){let r={driverId:e[Math.floor(Math.random()*e.length)].id,amount:(Math.random()*10).toFixed(2),eventTime:new Date().toISOString()};console.log(`sending sample tipping event ${JSON.stringify(r)}`),await Rt.sendMessage({QueueUrl:t,MessageBody:JSON.stringify(r)}).promise()}};0&&(module.exports={handleCreateDriversTestData,handleSampleDriverTippingEvent});
//# sourceMappingURL=index.js.map
